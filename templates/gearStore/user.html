{% extends 'gearStore/base.html' %}
{% load gearstore_template_tags %}
{% load staticfiles %}

{% block title_block %}
    {% if user_page_profile %}
        {{ user_page_profile.first_name }} {{ user_page_profile.last_name }}'s Account
    {% else %}
        Missing Account
    {% endif %}
{% endblock %}

{% block body_block %}
    {% if user_page_profile %}
        <h1 id="page-header">{{ user_page_profile.first_name }} {{ user_page_profile.last_name }}'s Account</h1>
        <div id="account-header" class="admin-user-view-header">
            <img class="profile-picture" src="/media/{{ user_page_profile.picture }}">
            <div id="welcome-buttons-holder">
                <div id="welcome-text">
                    <p id="welcome-text-username">{{user_page_profile.first_name}} {{ user_page_profile.last_name }}</p>
                </div>
            </div>
        </div>
        <div class="gear-view-contents">
            <div class="text-widget" id="booking-view-text-widget">
                <div id="username-section" class="widget-section">
                    <p class="widget-label">Username</p>
                    <div class="widget-bottom">
                        <p class="widget-text">{{ user_page_profile.user.username }}</p>
                    </div>
                </div>
                <div id="name-section" class="widget-section">
                    <p class="widget-label">Name</p>
                    <div class="widget-bottom">
                        <p class="widget-text">{{user_page_profile.first_name}} {{ user_page_profile.last_name }}</p>
                    </div>
                </div>
                <div id="booking-link-section" class="widget-section">
                    <p class="widget-label">Admin Status</p>
                    <div class="widget-bottom">
                        {% if user_page_profile.adminStatus %}
                            <p class="widget-text">Admin</p>
                        {% else %}
                            <p class="widget-text">Not Admin</p>
                        {% endif %}
                    </div>
                </div>
            </div>
            <div class="text-widget" id="contact-detail-view-text-widget">
                <div id="borrower-contact-section" class="widget-section">
                    <p class="widget-label">User Contact Email</p>
                    <div class="widget-bottom">
                        <p class="widget-text">{{ user_page_profile.user.email }}</p>
                    </div>
                </div>
            </div>
        </div>
        <br>
        <br>
        <h3>{{user_page_profile.first_name}} {{ user_page_profile.last_name }}'s Bookings</h3>
        <br>
        <div class="gear-view-contents" id="user-bookings">
        {% if user_bookings %}
            {% for booking in user_bookings %}
                <div class="text-widget" id="category-view-text-widget" style="background-color: {% get_colour booking.id %};">
                    <div id="gear-item-section" class="widget-section">
                        <p class="widget-label">Gear Item</p>
                        <div class="widget-bottom">
                            <p class="widget-text"><a href="{% url 'gearStore:view-gear' booking.gearItem.slug %}">{{ booking.gearItem.name }}</a></p>
                        </div>
                    </div>
                    <div id="return-date-section" class="widget-section">
                        <p class="widget-label">Borrowed Until</p>
                        <div class="widget-bottom">
                            <p class="widget-text">{{ booking.dateToReturn }}</p>
                        </div>
                    </div>
                    <div id="borrow-status-section" class="widget-section">
                        <p class="widget-label">Status</p>
                        <div class="widget-bottom">
                            <p class="widget-text">{{ booking.status }}</p>
                        </div>
                    </div>
                    <div id="booking-link-section" class="widget-section">
                        <p class="widget-label">Booking</p>
                        <div class="widget-bottom">
                            <p class="widget-text"><a href="{% url 'gearStore:booking' booking.id %}">View Booking</a></p>
                        </div>
                    </div>
                </div>
            {% endfor %}
        {% else %}
            <p id="no-gear-error">You currently have no borrowed Gear.</p>
        {% endif %}
        </div>

    {% else %}
        <h1 id="page-header">Missing Account</h1>
        <p>Error: No such username exists.</p>
    {% endif %}
{% endblock %}